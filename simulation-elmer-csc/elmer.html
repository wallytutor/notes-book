
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Elmer Fundamentals &#8212; Notes Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'simulation-elmer-csc/elmer';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solver Input Files (SIF)" href="sif.html" />
    <link rel="prev" title="Elmer Multiphysics" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Notes Book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Notes Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Notes Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Scientific computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../scientific-computing/introduction.html">Scientific computing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-git.html">Git version control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-ssh.html">SSH key generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-containers.html">Using containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-selection.html">Selection of tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-portable.html">Portable toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/system-windows.html">Working on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/system-linux.html">Working on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/programming.html">Scientific programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/general-tips.html">General Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/services.html">Deploying services</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/mpc-kinetics-intro.html">Fundamentals of MPC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-a.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-b.html">Refactoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-c.html">Wrapping up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-boiling-evaporation.html">How to model an evaporation/boiling process?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-multiple-shooting.html">DAE multiple shooting solution</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/thermo-notes-intro.html">Thermodynamics and kinetics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/thermo-converting-shomate.html">Converting data to Shomate format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/thermo-calphad-nitrides.html">Gibbs energy analysis of <span class="math notranslate nohighlight">\(Si_3N_4\)</span> and <span class="math notranslate nohighlight">\(MnSiN_2\)</span></a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/image-notes-intro.html">Image analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/image-porosity-measurement.html">Porosity quantification</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Julia tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../julia/intro.html">Introduction to Julia</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../julia/julia101.html">Julia 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../julia/julia-tips.html">Julia tips</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ansys Fluent</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../simulation-ansys-fluent/tui.html">Text user interface (TUI)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Elmer CSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Elmer Multiphysics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Elmer Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sif.html">Solver Input Files (SIF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="matc.html">MATC</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cases.html">Elmer cases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-1/README.html">Heat conduction in Elmer</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-2/README.html">Pseudo-solidification formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-3/README.html">Elmer verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/thermomechanical-1/README.html">Thermomechanical simulation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../coding-notes/haskell.html">Minimal Haskell</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/wallytutor/notes-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/wallytutor/notes-book/issues/new?title=Issue%20on%20page%20%2Fsimulation-elmer-csc/elmer.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/simulation-elmer-csc/elmer.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Elmer Fundamentals</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-steps">Preprocessing steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-elmer">Using Elmer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-computing">Parallel computing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-and-ideas">Tips and ideas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-properties">Material properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#postprocessing">Postprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-defined-functions">User-defined functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-fields">Derived fields</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-data-modules">Saving data modules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfoam-coupling">OpenFOAM coupling</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="elmer-fundamentals">
<h1>Elmer Fundamentals<a class="headerlink" href="#elmer-fundamentals" title="Link to this heading">#</a></h1>
<section id="preprocessing-steps">
<h2>Preprocessing steps<a class="headerlink" href="#preprocessing-steps" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Other than the native <code class="docutils literal notranslate"><span class="pre">ElmerGrid</span></code>, several other software can be used for conceiving a geometry and mesh generation workflow. Users are encouraged to use external tools such as <a class="reference external" href="https://gmsh.info/">gmsh</a> or <a class="reference external" href="https://www.salome-platform.org/">Salome</a> to generate computational meshes, built-in support in Elmer bein limited to very simple geometries only. For complex geometries <a class="reference external" href="https://www.freecad.org/">FreeCAD</a> is a standout alternative. For more consider reading <em>Geometry and Preprocessing</em>.</p></li>
<li><p>Not all <code class="docutils literal notranslate"><span class="pre">gmsh</span></code> standard mesh formats are supported, but only version 2 (as for OpenFOAM); that said, users are encouraged to export mesh in UNV format to avoid compatibility issues, and also because both proposed tools support it. You can control the element orders in command line using option <code class="docutils literal notranslate"><span class="pre">-order</span> <span class="pre">&lt;N&gt;</span></code>; gmsh operates this way so that the same script can generate any supported element type.</p></li>
<li><p>For importing meshes one uses <code class="docutils literal notranslate"><span class="pre">ElmerGrid</span> <span class="pre">&lt;input-format&gt;</span> <span class="pre">&lt;output-format&gt;</span></code>, where the format arguments are documented in the <a class="reference external" href="https://www.nic.funet.fi/pub/sci/physics/elmer/doc/ElmerGridManual.pdf">manual</a> sections 1.3 and 1.4. The UNV input is given by number 8 while standard <code class="docutils literal notranslate"><span class="pre">ElmerSolver</span></code> output by number 2, so that the conversion command would start with <code class="docutils literal notranslate"><span class="pre">ElmerGrid</span> <span class="pre">8</span> <span class="pre">2</span> <span class="pre">&lt;other-arguments...&gt;</span></code>. Always verify the number of nodes remain untouched after conversion - or if it changed when using option <code class="docutils literal notranslate"><span class="pre">-merge</span> <span class="pre">&lt;dist&gt;</span></code>, merging nodes that are closer than the user-defined <code class="docutils literal notranslate"><span class="pre">&lt;dist&gt;</span></code>.</p></li>
<li><p>Remember to use <code class="docutils literal notranslate"><span class="pre">Coherence;</span></code>  with OpenCASCADE factory in gmsh scripts to automatically strip internal faces; that might not be enough for complex cases, see below. <strong>Note:</strong> I tried doing so and unless <code class="docutils literal notranslate"><span class="pre">Physical</span> <span class="pre">Surfaces</span></code> naming the external boundaries are provided every interface is dumped and imported by Elmer; maybe I misunderstood the use of command!</p></li>
<li><p>Because faces are not named in Elmer, <em>i.e.</em> no matter what <code class="docutils literal notranslate"><span class="pre">Physical</span> <span class="pre">Surface</span></code> names you provide in gmsh, even for the advanced user working from command line it might be interesting to use the interactive zone grouping capabilities of <code class="docutils literal notranslate"><span class="pre">ElmerGUI</span></code>. That might even become a <em>requirement</em> as geometric complexity grows.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Software</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FreeCAD</p></td>
<td><p>Geometry only for now, probably the best in the list; good parametric modeling support. Has native Elmer integration.</p></td>
</tr>
<tr class="row-odd"><td><p>Salome</p></td>
<td><p>Can export UNV (8) meshes readable by Elmer. An extension to call Elmer directly from Salome is under development.</p></td>
</tr>
<tr class="row-even"><td><p>gmsh</p></td>
<td><p>Can export MSH2 (14) and UNV (8) formats readable by Elmer.</p></td>
</tr>
<tr class="row-odd"><td><p>netgen</p></td>
<td><p>Is able to write native Elmer linear meshes; can be used as a plug-in.</p></td>
</tr>
<tr class="row-even"><td><p>tetgen</p></td>
<td><p>Can be used as a plug-in.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="using-elmer">
<h2>Using Elmer<a class="headerlink" href="#using-elmer" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Newcomers might be interested in <code class="docutils literal notranslate"><span class="pre">ElmerGUI</span></code>; although very intuitive, the interface is quite limited and for complex programs running from command line is the preferred mode.</p></li>
<li><p>Most users will finally end setting up an workflow employing both to <code class="docutils literal notranslate"><span class="pre">ElmerSolver</span></code> (to run the simulations) and <code class="docutils literal notranslate"><span class="pre">ElmerGrid</span></code> (to prepare the grid and setup parallelization).</p></li>
<li><p>There is also <code class="docutils literal notranslate"><span class="pre">ViewFactors</span></code> which might be useful in special cases involving radiation and other executables but they are not mentioned here because they fall in the legacy code family.</p></li>
<li><p>Users must be aware that Elmer has no default unit system; one must take care that units are coherent across the different models and materials.</p></li>
<li><p>Support to mathematical operations in SIF through MATC, which has its own <a class="reference external" href="https://www.nic.funet.fi/pub/sci/physics/elmer/doc/MATCManual.pdf">syntax and documentation</a>. It can be used, <em>e.g.</em> for computing temperature dependent properties, what can be helpful for simple expressions (instead of writing Fortran 90 code for extensions).</p></li>
</ul>
</section>
<section id="parallel-computing">
<h2>Parallel computing<a class="headerlink" href="#parallel-computing" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Before running in parallel a working case running in serial is required; using <code class="docutils literal notranslate"><span class="pre">ElmerGUI</span></code> this can be enabled in <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">&gt;</span> <span class="pre">Parallel</span> <span class="pre">settings...</span></code>. Notice that after running postprocessing of <code class="docutils literal notranslate"><span class="pre">.pvtu</span></code> needs to be done in ParaView directly.</p></li>
<li><p>To partition the mesh from command line one needs to run <code class="docutils literal notranslate"><span class="pre">ElmerGrid</span> <span class="pre">2</span> <span class="pre">2</span> <span class="pre">&lt;mesh-name&gt;</span> <span class="pre">-partdual</span> <span class="pre">-metiskway</span> <span class="pre">&lt;N&gt;</span></code>, which will convert <code class="docutils literal notranslate"><span class="pre">&lt;mesh-name&gt;</span></code> from Elmer mesh format (2) into itself (thus the <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2</span></code> in the command) and dump the resulting mesh in <code class="docutils literal notranslate"><span class="pre">partitions.&lt;N&gt;</span></code>, with <code class="docutils literal notranslate"><span class="pre">&lt;N&gt;</span></code> being the number of physical cores to run the simulation.</p></li>
<li><p>Parallel cases can be run with <code class="docutils literal notranslate"><span class="pre">mpiexec</span> <span class="pre">-n</span> <span class="pre">&lt;N&gt;</span> <span class="pre">ElmerSolver_mpi</span></code>. Notice that under Linux the MPI runner is called <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> instead of <code class="docutils literal notranslate"><span class="pre">mpiexec</span></code>.</p></li>
</ul>
</section>
<section id="tips-and-ideas">
<h2>Tips and ideas<a class="headerlink" href="#tips-and-ideas" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">Coordinate</span> <span class="pre">Mapping</span></code> to rotate meshes with oriented particles</p></li>
<li><p>Scaling of a single direction can be done with <code class="docutils literal notranslate"><span class="pre">Coordinate</span> <span class="pre">Scaling</span></code></p></li>
<li><p>Time step can be changed with a list of elements in <code class="docutils literal notranslate"><span class="pre">Timestep</span> <span class="pre">Intervals</span></code>, <em>e.g.</em></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Run 10 time-steps of 0.1 s, then 100 with 1.0 s.
Timestep Intervals(2) = 10 100
Timestep Sizes(2) = 0.1 1.0
</pre></div>
</div>
<ul class="simple">
<li><p>Take care with <code class="docutils literal notranslate"><span class="pre">Linear</span> <span class="pre">System</span> <span class="pre">Abort</span> <span class="pre">Not</span> <span class="pre">Converged</span> <span class="pre">=</span> <span class="pre">True</span></code> for physical consistency; generally continuing a simulation after a failed step is worthless unless one is pseudo-stepping towards a difficult (highly nonlinear) steady-state.</p></li>
</ul>
</section>
<section id="material-properties">
<h2>Material properties<a class="headerlink" href="#material-properties" title="Link to this heading">#</a></h2>
<p>Material properties can be specified as:</p>
<ul class="simple">
<li><p>Constant: just the default numeric input in SIF files</p></li>
<li><p>Tabulated linearly or using a cubic spline, <em>e.g.</em></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Linear interpolation
Viscosity = Variable Temperature
  Real
	298.15 1.0
	! ... more data here
	373.15 2.0
End

! Cubic spline interpolation
Viscosity = Variable Temperature
  Real cubic
	298.15 1.0
	315.15 1.1
	345.15 1.5
	! ... more data here
	373.15 2.0
End
</pre></div>
</div>
<ul class="simple">
<li><p>Arrays: for representing anisotropic bodies, <em>e.g.</em></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Heat</span> <span class="n">Conductivity</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>\
                         <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span>\
                         <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Using MATC as explained below in this page. Notice that sourcing files in MATC is the recommended way to get reusable code; coding MATC in SIF files requires to escape all lines and quickly becomes messy.</p></li>
<li><p>User-defined functions (UDF) can also be provided in Fortran; notice that even when MATC can be used, this may lead to a speed-up of calculations with the inconvenient of needing more code. So for cases that are intended to be reused, it is important to consider writing proper extensions in Fortran. The following example illustrates a temperature dependent thermal conductivity function which is evaluated by Elmer at all nodes. In most cases a simple <code class="docutils literal notranslate"><span class="pre">USE</span> <span class="pre">DefUtils</span></code> is enough to get the required Elmer API to write the extension.</p></li>
</ul>
<div class="highlight-Fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">conductivity</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="nb">time</span><span class="p">)</span><span class="w"> </span><span class="k">RESULT</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="c">!**************************************************************</span>
<span class="w">    </span><span class="c">! Load Elmer library.</span>
<span class="w">    </span><span class="c">!**************************************************************</span>

<span class="w">    </span><span class="k">USE </span><span class="n">DefUtils</span>
<span class="w">    </span><span class="k">IMPLICIT None</span>

<span class="w">    </span><span class="c">!**************************************************************</span>
<span class="w">    </span><span class="c">! Function interface.</span>
<span class="w">    </span><span class="c">!**************************************************************</span>

<span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">Model_t</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">model</span>
<span class="w">    </span><span class="kt">INTEGER</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">time</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>

<span class="w">    </span><span class="c">!**************************************************************</span>
<span class="w">    </span><span class="c">! Function internals.</span>
<span class="w">    </span><span class="c">!**************************************************************</span>

<span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">Variable_t</span><span class="p">),</span><span class="w"> </span><span class="k">POINTER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">varptr</span>
<span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">T</span>
<span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idx</span>

<span class="w">    </span><span class="c">!**************************************************************</span>
<span class="w">    </span><span class="c">! Actual implementation</span>
<span class="w">    </span><span class="c">!**************************************************************</span>

<span class="w">    </span><span class="c">! Retrieve pointer to the temperature variable.</span>
<span class="w">    </span><span class="n">varptr</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">VariableGet</span><span class="p">(</span><span class="n">model</span><span class="p">%</span><span class="n">Variables</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>

<span class="w">    </span><span class="c">! Access index of current node.</span>
<span class="w">    </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">varptr</span><span class="p">%</span><span class="n">Perm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="w">    </span><span class="c">! Retrieve nodal temperature.</span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">varptr</span><span class="p">%</span><span class="n">Values</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

<span class="w">    </span><span class="c">! Compute heat conductivity from NodalTemperature, k=k(T)</span>
<span class="w">    </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">2.5e-03</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0e-06</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">T</span><span class="p">)</span>
<span class="k">END FUNCTION </span><span class="n">conductivity</span>
</pre></div>
</div>
<p>In order to compile the above assume it is written to <code class="docutils literal notranslate"><span class="pre">properties.f90</span></code> file; then one can call <code class="docutils literal notranslate"><span class="pre">elmerf90</span> <span class="pre">properties.f90</span> <span class="pre">–o</span> <span class="pre">properties</span></code> to generate the required shared library that is loaded in runtime by Elmer. Below we illustrate the use of <code class="docutils literal notranslate"><span class="pre">Procedure</span></code> to attach this library to a given material; first one provides the name of the shared library then the name of the function. A single library can in fact contain several functionalities.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">Material</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Solid&quot;</span>
<span class="w">  </span><span class="n">Heat</span><span class="w"> </span><span class="n">Conductivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Time</span>
<span class="w">    </span><span class="n">Procedure</span><span class="w"> </span><span class="s">&quot;properties&quot;</span><span class="w"> </span><span class="s">&quot;conductivity&quot;</span>
<span class="w">  </span><span class="n">Heat</span><span class="w"> </span><span class="n">Capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">  </span><span class="n">Density</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2500</span>
<span class="n">End</span>
</pre></div>
</div>
</section>
<section id="postprocessing">
<h2>Postprocessing<a class="headerlink" href="#postprocessing" title="Link to this heading">#</a></h2>
<p>For postprocessing the recommended way is by using external tools as <a class="reference external" href="https://www.paraview.org/">ParaView</a> and <a class="reference external" href="https://docs.pyvista.org/version/stable/">PyVista</a>, both handling well the VTK format of outputs. Nonetheless there are a some in-solver processing utilities that are worth knowing, especially in what concerns extracting and filtering data from certain regions, creating new fields, and computing fluxes.</p>
<ul class="simple">
<li><p>Creating a new scalar</p></li>
</ul>
<p>The keyword set of materials is actually not fixed; one can, for instance, create composition field in different units with MATC, as illustrated below (case <a class="reference internal" href="#cases/diffusion-1/carburizing_slycke_gui"><span class="xref myst">here</span></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MoleFraction</span> <span class="o">=</span> <span class="n">Variable</span> <span class="n">Concentration</span>
  <span class="n">Real</span> <span class="n">MATC</span> <span class="s2">&quot;carbonmolefraction(tx)&quot;</span>
</pre></div>
</div>
<p>Then in solver <code class="docutils literal notranslate"><span class="pre">SaveMaterials</span></code>, this new name <code class="docutils literal notranslate"><span class="pre">MoleFraction</span></code> can be used as a variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Solver</span> <span class="mi">1</span>
  <span class="n">Equation</span> <span class="o">=</span> <span class="n">SaveMaterials</span>
  <span class="n">Parameter</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">Concentration</span> <span class="n">Diffusivity</span>
  <span class="n">Parameter</span> <span class="mi">2</span> <span class="o">=</span> <span class="n">MoleFraction</span>
  <span class="n">Procedure</span> <span class="o">=</span> <span class="s2">&quot;SaveData&quot;</span> <span class="s2">&quot;SaveMaterials&quot;</span>
  <span class="n">Exec</span> <span class="n">Solver</span> <span class="o">=</span> <span class="n">After</span> <span class="n">Timestep</span>
<span class="n">End</span>
</pre></div>
</div>
<p>Another situation that can be frequently found is unit conversion for temperature. It was chosen to implement it in <a class="reference internal" href="#cases/conduction-4/transient_parallel"><span class="xref myst">this case</span></a> because it is multi-material; that is a reminder that in such cases the new variable needs to be created for all materials (as this is a tweak, since the temperature is not a material property, but a global field). If forgotten in one material, an error will show up in ParaView telling you that the field is not available in some regions.</p>
</section>
<section id="user-defined-functions">
<h2>User-defined functions<a class="headerlink" href="#user-defined-functions" title="Link to this heading">#</a></h2>
<p><em>Upcoming</em></p>
<section id="derived-fields">
<h3>Derived fields<a class="headerlink" href="#derived-fields" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>StreamSolver</p></li>
<li><p>FluxSolver</p></li>
</ul>
<p>#elmer/models/flux-solver</p>
<ul class="simple">
<li><p>VorticitySolver</p></li>
<li><p>DivergenceSolver</p></li>
<li><p>ScalarPotentialSolver</p></li>
<li><p>ArtificialCompressibility</p></li>
<li><p>FluidicForce</p></li>
<li><p>ElectricForce</p></li>
<li><p>RigidBodyReduction</p></li>
<li><p>FilterTimeSeries</p></li>
<li><p>DataToFieldSolver</p></li>
<li><p>ProjectToPlane</p></li>
<li><p>StructureProjectToPlane</p></li>
<li><p>FindOptimum</p></li>
</ul>
</section>
<section id="saving-data-modules">
<h3>Saving data modules<a class="headerlink" href="#saving-data-modules" title="Link to this heading">#</a></h3>
<p><strong>Note</strong>: coupling to OpenFOAM is discussed separately in another section.</p>
<ul class="simple">
<li><p>SaveData</p></li>
<li><p>SaveScalars</p></li>
</ul>
<p>#elmer/models/save-scalars</p>
<ul class="simple">
<li><p>SaveLine</p></li>
</ul>
<p>#elmer/models/save-line</p>
<ul class="simple">
<li><p>SaveMaterials</p></li>
<li><p>SaveBoundaryValues</p></li>
<li><p>ResultOutputSolve</p></li>
<li><p>ResultOutputSolver</p></li>
</ul>
<p>#elmer/models/result-output-solver</p>
<ul class="simple">
<li><p>SaveGridData</p></li>
<li><p>SaveGridData</p></li>
<li><p>Isosurface</p></li>
<li><p>IsosurfaceSolver</p></li>
</ul>
</section>
<section id="openfoam-coupling">
<h3>OpenFOAM coupling<a class="headerlink" href="#openfoam-coupling" title="Link to this heading">#</a></h3>
<p>…</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./simulation-elmer-csc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Elmer Multiphysics</p>
      </div>
    </a>
    <a class="right-next"
       href="sif.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Solver Input Files (SIF)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-steps">Preprocessing steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-elmer">Using Elmer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-computing">Parallel computing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-and-ideas">Tips and ideas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#material-properties">Material properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#postprocessing">Postprocessing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-defined-functions">User-defined functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derived-fields">Derived fields</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-data-modules">Saving data modules</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#openfoam-coupling">OpenFOAM coupling</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Walter Dal'Maz Silva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>