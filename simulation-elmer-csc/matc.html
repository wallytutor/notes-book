
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MATC &#8212; Notes Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'simulation-elmer-csc/matc';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Elmer cases" href="cases.html" />
    <link rel="prev" title="Solver Input Files (SIF)" href="sif.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Notes Book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Notes Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Welcome to Notes Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Scientific computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../scientific-computing/introduction.html">Scientific computing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-git.html">Git version control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-ssh.html">SSH key generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-containers.html">Using containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-selection.html">Selection of tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/tools-portable.html">Portable toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/system-windows.html">Working on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/system-linux.html">Working on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/programming.html">Scientific programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/general-tips.html">General Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scientific-computing/services.html">Deploying services</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/mpc-kinetics-intro.html">Fundamentals of MPC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-a.html">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-b.html">Refactoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-kinetics-part-c.html">Wrapping up</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-boiling-evaporation.html">How to model an evaporation/boiling process?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/mpc-multiple-shooting.html">DAE multiple shooting solution</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/thermo-notes-intro.html">Thermodynamics and kinetics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/thermo-converting-shomate.html">Converting data to Shomate format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/thermo-calphad-nitrides.html">Gibbs energy analysis of <span class="math notranslate nohighlight">\(Si_3N_4\)</span> and <span class="math notranslate nohighlight">\(MnSiN_2\)</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/thermo-scraper-minerals.html">Data recovery from THERMODDEM webpage</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/image-notes-intro.html">Image analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/image-porosity-measurement.html">Porosity quantification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/image-metadata-extraction.html">Getting image metadata</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Julia tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../julia/intro.html">Introduction to Julia</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../julia/julia101.html">Julia 101</a></li>
<li class="toctree-l2"><a class="reference internal" href="../julia/julia-tips.html">Julia tips</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ansys Fluent</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../simulation-ansys-fluent/tui.html">Text user interface (TUI)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Elmer CSC</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Elmer Multiphysics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="elmer.html">Elmer Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sif.html">Solver Input Files (SIF)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">MATC</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="cases.html">Elmer cases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-1/README.html">Heat conduction in Elmer</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-2/README.html">Pseudo-solidification formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/conduction-3/README.html">Elmer verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="cases/thermomechanical-1/README.html">Thermomechanical simulation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Coding notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../coding-notes/haskell.html">Minimal Haskell</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Montagne</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../montagne/liens.html">Liens utiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../montagne/carto.html">Cartographie</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/wallytutor/notes-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/wallytutor/notes-book/issues/new?title=Issue%20on%20page%20%2Fsimulation-elmer-csc/matc.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/simulation-elmer-csc/matc.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MATC</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declaring-variables">Declaring variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#control-structures">Control structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-definitions">Function definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-functions">Built-in functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="matc">
<h1>MATC<a class="headerlink" href="#matc" title="Link to this heading">#</a></h1>
<p>Elmer provides a few extension methods. For complex models you might be prompted to use directly Fortran 90. For simpler things, such as providing temperature dependent thermophysical properties, it has its own parser for use in SIF, the metalanguage MATC. Expressions provided in MATC can be evaluated when file is read or during simulation execution.</p>
<p>Because it is quite concise, I summarized the whole of MATC syntax and functions in this page. For the official documentation please refer to <a class="reference external" href="https://www.nic.funet.fi/pub/sci/physics/elmer/doc/MATCManual.pdf">this document</a>.</p>
<section id="declaring-variables">
<h2>Declaring variables<a class="headerlink" href="#declaring-variables" title="Link to this heading">#</a></h2>
<p>Variables in MATC can be matrices and strings; nonetheless, both are stored as double precision arrays so creating large arrays of strings can represent a waste of memory. For some weird reason I could not yet figure out, MATC language can be quite counterintuitive.</p>
<p>Let’s start by creating a variable, say <code class="docutils literal notranslate"><span class="pre">x</span></code> below; attribution, such a in Python, creates the variable. It was stated that everything is a matrix or string; since <code class="docutils literal notranslate"><span class="pre">x</span></code> is not a string, it is actually a <span class="math notranslate nohighlight">\(1\times{}1\)</span> matrix and in this case we can omit the indexing when allocating its memory.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>So far nothing weird; when declaring a string as <code class="docutils literal notranslate"><span class="pre">k</span></code> below we are actually creating a <span class="math notranslate nohighlight">\(1\times{}5\)</span> row matrix, what is not unusual in many programming languages (except for being double precision here). Furthermore, we use the typical double-quotes notation for strings.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hello&quot;</span>
</pre></div>
</div>
<p>Matrix indexing is zero-based, as in C or Python. Matrix slicing is done as in many scripting languages, such as Python, Julia, Octave, …, and we can reverse the order of the first <em>six</em> elements of an array <code class="docutils literal notranslate"><span class="pre">y</span></code> as follows:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice above the fact that matrix slicing is <em>last-inclusive</em>, as in Julia, meaning that all elements from index zero to five <em>inclusive</em> are included in the slice. Weirdness starts when you do something like</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">142857</span>
</pre></div>
</div>
<p>which according to the documentation will produce an array <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">4</span> <span class="pre">2</span> <span class="pre">8</span> <span class="pre">5</span> <span class="pre">7</span> <span class="pre">1</span> <span class="pre">4</span> <span class="pre">2</span> <span class="pre">8</span></code>; I could not verify this behavior yet. Additionally, the following produces another unexpected result:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">z</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</pre></div>
</div>
<p>If matrix <code class="docutils literal notranslate"><span class="pre">z</span></code> does not exist, this results in a <span class="math notranslate nohighlight">\(10\times{}10\)</span> matrix with all zeros except the explicitly declared element. The size of variables are dynamic, so in the above if <code class="docutils literal notranslate"><span class="pre">z</span></code> already existed but wa smaller, it would be padded with zeros instead.</p>
<p>Finally, logical indexing is also allowed:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.05</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.05</span>
</pre></div>
</div>
</section>
<section id="control-structures">
<h2>Control structures<a class="headerlink" href="#control-structures" title="Link to this heading">#</a></h2>
<p>MATC provides conditionals and loops as control structures. Below we have the <code class="docutils literal notranslate"><span class="pre">if-else</span></code> statement, which can be declared inline of using a C-style declaration using braces.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="p">;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">expr</span><span class="p">;</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Loops can be declared using both <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code>. There is no mechanism of generating values within a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and one must provide a vector of indexes for repetition. <em>In the official documentation there is no reference to a <code class="docutils literal notranslate"><span class="pre">continue</span></code> or <code class="docutils literal notranslate"><span class="pre">break</span></code> statement and I could not verify their existence yet</em>.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">vector</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="n">vector</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">expr</span><span class="p">;</span>

<span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="n">expr</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">expr</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h2>
<p>Assume the following definitions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code> ordinary matrices</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code> logical matrices</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">m</span></code> scalars</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">a'</span></code></p></td>
<td class="text-left"><p>is transpose of matrix a.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">&#64;a</span></code></p></td>
<td class="text-left"><p>evaluate content of a string variable a as a MATC statement.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">~l</span></code></p></td>
<td class="text-left"><p>elementwise logical not of  if x is not zero.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">^</span> <span class="pre">s</span></code></p></td>
<td class="text-left"><p>if a is a square matrix and s is integral, a matrix power is computed, otherwise an elementwise power.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>if a and b are compatible for matrix product, that is computed, otherwise if they are of the same size or at least one of them is scalar, an elementwise product is computed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">#</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>elementwise multiplication of a and b.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">/</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>is fraction of a and b computed elementwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>is sum of matrices a and b computed elementwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>is difference of matrices a and b computed elementwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>equality of matrices a and b elementwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">&lt;&gt;</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>inequality of matrices a and b elementwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>true if a is less than b computed elementwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>true if a is greater than b computed elementwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>true if a is less than or equal to b computed elementwise.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>true if a is greater than or equal to b computed elementwise.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">:</span> <span class="pre">m</span></code></p></td>
<td class="text-left"><p>return a vector of values starting from n and ending to m by increment of (plus-minus) one.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">l</span> <span class="pre">&amp;</span> <span class="pre">t</span></code></p></td>
<td class="text-left"><p>elementwise logical and of a and b.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">l</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>elementwise logical or of a and b.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">?</span> <span class="pre">b</span></code></p></td>
<td class="text-left"><p>reduction: set values of a where b is zero to zero.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">m</span> <span class="pre">%</span> <span class="pre">a</span></code></p></td>
<td class="text-left"><p>resize a to matrix of size n by m.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">a</span></code></p></td>
<td class="text-left"><p>assigning a to b.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="function-definitions">
<h2>Function definitions<a class="headerlink" href="#function-definitions" title="Link to this heading">#</a></h2>
<p>The syntax of the function definition is similar to that of Julia and is given below. The function body is enclosed by braces. Instead of using a <code class="docutils literal notranslate"><span class="pre">return</span></code> statement, the resulting value is attributed to a variable named after the function with a leading underscore. Notice the <code class="docutils literal notranslate"><span class="pre">!</span></code> denoting comments in the description of the function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>function name(arg1, arg2, ...)
!
! Optional function description (seen with help(&quot;name&quot;))
!
import var1, var2
export var3, var4
{
    expr;
     ...
    expr;

    _name = value
}
</pre></div>
</div>
<p>Functions have their own list of variables. Global variables are not seen in this function unless imported by <code class="docutils literal notranslate"><span class="pre">import</span></code> or given as arguments. Local variables can be made global by the <code class="docutils literal notranslate"><span class="pre">export</span></code> statement.</p>
<p>Functions, if returning matrices, behave in many ways as variables do. So if you have defined function <code class="docutils literal notranslate"><span class="pre">mult</span></code> as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">mult</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">_mult</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can get element (3,5) of the <code class="docutils literal notranslate"><span class="pre">a</span></code> times <code class="docutils literal notranslate"><span class="pre">b</span></code> matrix with <code class="docutils literal notranslate"><span class="pre">mult(x,y)[3,5]</span></code> or the diagonal values of the same matrix by <code class="docutils literal notranslate"><span class="pre">diag(mult(x,</span> <span class="pre">y))</span></code>.</p>
</section>
<section id="built-in-functions">
<h2>Built-in functions<a class="headerlink" href="#built-in-functions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>C-style math</p></li>
</ul>
<p>The following listing provides a series of mathematical functions which follow a their meaning in C. The only exceptions are <code class="docutils literal notranslate"><span class="pre">ln</span></code> denoting the natural logarithm and <code class="docutils literal notranslate"><span class="pre">log</span></code> used here for base 10 logarithms.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">asin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cosh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>General utilities</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">funcdel(name)</span></code></p></td>
<td class="text-left"><p>Delete given function definition from parser.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">funclist(name)</span></code></p></td>
<td class="text-left"><p>Give header of the function given by name.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">env(name)</span></code></p></td>
<td class="text-left"><p>Get value of environment variable of the operating system.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exists(name)</span></code></p></td>
<td class="text-left"><p>Return true (non-zero) if variable by given name exists otherwise return false (=0).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source(name)</span></code></p></td>
<td class="text-left"><p>Execute commands from file given name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">format(precision)</span></code></p></td>
<td class="text-left"><p>Set number of digits used in printing values in MATC.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">eval(str)</span></code></p></td>
<td class="text-left"><p>Evaluate content of string str. Another form of this command is <code class="docutils literal notranslate"><span class="pre">&#64;str</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">who</span></code></p></td>
<td class="text-left"><p>Give list of currently defined variables.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">help</span></code> or <code class="docutils literal notranslate"><span class="pre">help(&quot;symbol&quot;)</span></code></p></td>
<td class="text-left"><p>First form of the command gives list of available commands. Second form gives help on specific routine.</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>String and I/O functions</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">=</span> <span class="pre">sprintf(fmt[,vec])</span></code></p></td>
<td class="text-left"><p>Return a string formatted using <code class="docutils literal notranslate"><span class="pre">fmt</span></code> and values from <code class="docutils literal notranslate"><span class="pre">vec</span></code>. A call to corresponding C-language function is made.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vec</span> <span class="pre">=</span> <span class="pre">sscanf(str,fmt)</span></code></p></td>
<td class="text-left"><p>Return values from <code class="docutils literal notranslate"><span class="pre">str</span></code> using format <code class="docutils literal notranslate"><span class="pre">fmt</span></code>. A call to corresponding C-language function is made.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">=</span> <span class="pre">fread(fp,n)</span></code></p></td>
<td class="text-left"><p>Read <code class="docutils literal notranslate"><span class="pre">n</span></code> bytes from file given by <code class="docutils literal notranslate"><span class="pre">fp</span></code>. File pointer fp should have been obtained from a call to <code class="docutils literal notranslate"><span class="pre">fopen</span></code> or <code class="docutils literal notranslate"><span class="pre">freopen</span></code>, or be the standard input file stdin. Data is returned as function value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">vec</span> <span class="pre">=</span> <span class="pre">fscanf(fp,fmt)</span></code></p></td>
<td class="text-left"><p>Read file <code class="docutils literal notranslate"><span class="pre">fp</span></code> as given in format. Format fmt is equal to C-language format. File pointer <code class="docutils literal notranslate"><span class="pre">fp</span></code> should have been obtained from a call to <code class="docutils literal notranslate"><span class="pre">fopen</span></code> or <code class="docutils literal notranslate"><span class="pre">freopen</span></code>, or be the standard input.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">=</span> <span class="pre">fgets(fp)</span></code></p></td>
<td class="text-left"><p>Read next line from fp. File pointer fp should have been obtained from a call to fopen or freopen or be the standard input.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">fwrite(fp,buf,n)</span></code></p></td>
<td class="text-left"><p>Write n bytes from buf to file fp. File pointer fp should have been obtained from a call to fopen or freopen or be the standard output (stdout) or standard error (stderr). Return value is number of bytes actually written. Note that one matrix element reserves 8 bytes of space.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">=</span> <span class="pre">fprintf(fp,fmt[,</span> <span class="pre">vec])</span></code></p></td>
<td class="text-left"><p>Write formatted string to file fp. File pointer fp should have been obtained from a call to fopen or freopen or be the standard output (stdout) or standard error (stderr). The format fmt is equal to C-language format.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fputs(fp,str)</span></code></p></td>
<td class="text-left"><p>Write string str to file fp. File pointer fp should have been obtained from a call to fopen or freopen or be the standard input (stdin).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fp</span> <span class="pre">=</span> <span class="pre">fopen(name,mode)</span></code></p></td>
<td class="text-left"><p>Reopen file given previous file pointer, name and access mode. The most usual modes are <code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code> for reading and <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> for writing. Return value fp is used in functions reading and writing the file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fp</span> <span class="pre">=</span> <span class="pre">freopen(fp,name,mode)</span></code></p></td>
<td class="text-left"><p>Reopen file given previous file pointer, name and access mode. The most usual modes are <code class="docutils literal notranslate"><span class="pre">&quot;r&quot;</span></code> for reading and <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> for writing. Return value fp is used in functions reading and writing the file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fclose(fp)</span> </code></p></td>
<td class="text-left"><p>Close file previously opened with fopen or freopen.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save(name,</span> <span class="pre">a[,ascii_flag])</span></code></p></td>
<td class="text-left"><p>Close file previously opened with <code class="docutils literal notranslate"><span class="pre">fopen</span></code> or <code class="docutils literal notranslate"><span class="pre">freopen</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">load(name)</span></code></p></td>
<td class="text-left"><p>Load matrix from a file given name and in format used by <code class="docutils literal notranslate"><span class="pre">save</span></code> command.</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Numerical utilities</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">min(matrix)</span></code></p></td>
<td class="text-left"><p>Return value is a vector containing smallest element in columns of given matrix. r = min(min(matrix)) gives smallest element of the matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">max(matrix)</span></code></p></td>
<td class="text-left"><p>Return value is a vector containing largest element in columns of given matrix. <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">max(max(matrix))</span></code> gives largest element of the matrix.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">sum(matrix)</span></code></p></td>
<td class="text-left"><p>Return vector is column sums of given matrix. <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">sum(sum(matrix))</span></code> gives the total sum of elements of the matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">zeros(n,m)</span></code></p></td>
<td class="text-left"><p>Return n by m matrix with elements initialized to zero.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">ones(n,m)</span></code></p></td>
<td class="text-left"><p>Return n by m matrix with elements initialized to one.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">rand(n,m)</span></code></p></td>
<td class="text-left"><p>Return n by m matrix with elements initialized with random numbers from zero to one.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">diag(a)</span></code></p></td>
<td class="text-left"><p>Given matrix return diagonal entries as a vector. Given vector return matrix with diagonal elements from vector. <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">diag(diag(a))</span></code> gives matrix with diagonal elements from matrix <code class="docutils literal notranslate"><span class="pre">a</span></code>, otherwise elements are zero.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">vector(start,end,inc)</span></code></p></td>
<td class="text-left"><p>Return vector of values going from start to end by inc.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">size(matrix)</span></code></p></td>
<td class="text-left"><p>Return size of given matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">resize(matrix,n,m)</span></code></p></td>
<td class="text-left"><p>Make a matrix to look as a <code class="docutils literal notranslate"><span class="pre">n</span></code> by <code class="docutils literal notranslate"><span class="pre">m</span></code> matrix. This is the same as <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">n</span> <span class="pre">m</span> <span class="pre">%</span> <span class="pre">matrix</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">where(a)</span></code></p></td>
<td class="text-left"><p>Return a row vector giving linear index to <code class="docutils literal notranslate"><span class="pre">a</span></code> where <code class="docutils literal notranslate"><span class="pre">a</span></code> is not zero.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">matcvt(matrix,</span> <span class="pre">type)</span></code></p></td>
<td class="text-left"><p>Makes a type conversion from MATC matrix double precision array to given type, which can be one of the following: <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;char&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">cvtmat(special,</span> <span class="pre">type)</span></code></p></td>
<td class="text-left"><p>Makes a type conversion from given type to MATC matrix. Type can be one of the following: <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;char&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p>Linear algebra</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-left"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">trace(matrix)</span></code></p></td>
<td class="text-left"><p>Return value is the sum of matrix diagonal elements.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">det(matrix)</span></code></p></td>
<td class="text-left"><p>Return value is determinant of given square matrix.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">inv(matrix)</span></code></p></td>
<td class="text-left"><p>Invert given square matrix. Computed also by operator <span class="math notranslate nohighlight">\(^{-1}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">tril(x)</span></code></p></td>
<td class="text-left"><p>Return the lower triangle of the matrix x.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">triu(x)</span></code></p></td>
<td class="text-left"><p>Return the upper triangle of the matrix x.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">eig(matrix)</span></code></p></td>
<td class="text-left"><p>Return eigenvalues of given square matrix. The expression <code class="docutils literal notranslate"><span class="pre">r(n,0)</span></code> is real part of the n:th eigenvalue, <code class="docutils literal notranslate"><span class="pre">r(n,1)</span></code> is the imaginary part respectively.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">jacob(a,b,eps)</span></code></p></td>
<td class="text-left"><p>Solve symmetric positive definite eigenvalue problem by Jacob iteration. Return values are the eigenvalues. Also a variable eigv is created containing eigenvectors.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">lud(matrix)</span></code></p></td>
<td class="text-left"><p>Return value is LUD decomposition of given matrix.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">hesse(matrix)</span></code></p></td>
<td class="text-left"><p>Return the upper hessenberg form of given matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">eye(n)</span></code></p></td>
<td class="text-left"><p>Return n by n identity matrix.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h2>
<p>Although the language is pretty fast for most simple uses, it is much slower than Fortran extensions, so use with case when scalability is needed. Another point is overuse of MATC; do not use it with simple numerical expressions, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">OneThird</span> <span class="pre">=</span> <span class="pre">Real</span> <span class="pre">$1.0/3.0</span></code> is much faster than its MATC counterpart <code class="docutils literal notranslate"><span class="pre">OneThird</span> <span class="pre">=</span> <span class="pre">Real</span> <span class="pre">MATC</span> <span class="pre">&quot;1.0/3.0&quot;</span></code>.</p>
<ul class="simple">
<li><p>Direct expression coding</p></li>
</ul>
<p>One thing that in my opinion lacks in the documentation are examples of use in conjunction with SIF. For instance, for setting the thermal conductivity of a material as temperature-dependent one could use the following snippet and modify the string to match the desired expression. An example of its usage is provided in <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/apps/Elmer/conduction_refractory/transient_parallel/case.sif">this case</a>.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">Heat</span><span class="w"> </span><span class="n">Conductivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Temperature</span>
<span class="w">    </span><span class="n">Real</span><span class="w"> </span><span class="n">MATC</span><span class="w"> </span><span class="s">&quot;1.0 - tx * (2.5E-03 - 1.2E-06 * tx)&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Sourcing functions from user modules</p></li>
</ul>
<p>Models can become too complex to code in a single line. Hopefully MATC provides functions which can be declared in external modules. I avoid coding MATC directly in SIF because their syntax is different and that can quickly lead to unmaintainable code. An example of such external sourcing is provided in <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/tree/main/apps/Elmer/diffusion_solids/carburizing_slycke">this case</a>. You need to remember to call <code class="docutils literal notranslate"><span class="pre">source(&quot;module&quot;)</span></code> in <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> section of SIF so that the functions can be used elsewhere.  The call of a function become something as</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">Concentration</span><span class="w"> </span><span class="n">Diffusivity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Concentration</span>
<span class="w">    </span><span class="n">Real</span><span class="w"> </span><span class="n">MATC</span><span class="w"> </span><span class="s">&quot;diffusivity(tx)&quot;</span>
</pre></div>
</div>
<p>if independent variable is concentration or for time</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">Mass</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Coefficient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Time</span>
<span class="w">    </span><span class="n">Real</span><span class="w"> </span><span class="n">MATC</span><span class="w"> </span><span class="s">&quot;masstransfercoef(tx)&quot;</span>
</pre></div>
</div>
<p>You can even use multiple variables, <em>e.g.</em></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">Mass</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Coefficient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="w"> </span><span class="n">Time</span><span class="p">,</span><span class="w"> </span><span class="n">Temperature</span>
<span class="w">    </span><span class="n">Real</span><span class="w"> </span><span class="n">MATC</span><span class="w"> </span><span class="s">&quot;masstransfercoef(tx(0), tx(1))&quot;</span>
</pre></div>
</div>
<p>PS: <em>I managed to use a single <code class="docutils literal notranslate"><span class="pre">source</span></code> in SIF, although the documentation does not state that many sources are forbidden; for some reason multiple sources work when sourcing from a file.</em></p>
<p>For more complex cases such as <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/tree/main/apps/Elmer/diffusion_solids/carburizing_slycke_gui">this one</a> it is worth writing actual MATC function modules; since there is no syntax highlighter available for MATC in VS Code, the <code class="docutils literal notranslate"><span class="pre">.ini</span></code> extension seems to provide better readability to the code. The problem was split in two parts: the <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/apps/Elmer/diffusion_solids/carburizing_slycke_gui/models.ini">models</a> which take care of sourcing the <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/apps/Elmer/diffusion_solids/carburizing_slycke_gui/conditions.ini">conditions</a>, so that basic users could only edit the latter and run their variant calculations with no coding skills. Notice that the symbols that are used in <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/apps/Elmer/diffusion_solids/carburizing_slycke_gui/case.sif">SIF</a> are exported from <a class="reference external" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/apps/Elmer/diffusion_solids/carburizing_slycke_gui/models.ini#L72">this line</a> instead of being set as global variables.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./simulation-elmer-csc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="sif.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Solver Input Files (SIF)</p>
      </div>
    </a>
    <a class="right-next"
       href="cases.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Elmer cases</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declaring-variables">Declaring variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#control-structures">Control structures</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-definitions">Function definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-functions">Built-in functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Walter Dal'Maz Silva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>